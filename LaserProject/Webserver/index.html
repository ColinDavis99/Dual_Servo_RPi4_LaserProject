<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
  </head>

  <style>
    .visible {
      visibility: visible;
    }
    .hidden {
      visibility: hidden;
    }
    .imgs {
      display: flex
    }
  </style>

  <body onload>
	<h1>Balloon Laser Game Version 1.3</h1>
	<h2>By Colin Davis and Sean Maglione</h2>
	<h3>For ELE408 - Embedded System Design<h3>
	<h3 style="margin-bottom: 100px">Instructor: Profressor Brenden Smerbeck</h3>


  <img class="hidden" src="win.gif" id="win" style="width: 400px; height: 400px"/>
  <h1 class="hidden" id="wintxt">You win!<h1>
  <h2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Balloon Map</h2>
  <canvas id="myCanvas" class="visible" width="460" height="400" style="border:1px solid #d3d3d3;">

	<script>

	function drawBalloonMap() {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
    ctx.arc(100, 120, 50, 0, 2 * Math.PI, false); // top left
    ctx.stroke();
	  ctx.beginPath();
	  ctx.lineWidth=2;
	  ctx.arc(220, 120, 50, 0, 2 * Math.PI, false); // top mid
    ctx.stroke();
	  ctx.beginPath();
	  ctx.lineWidth=2;
	  ctx.arc(340, 120, 50, 0, 2 * Math.PI, false); // top right
    ctx.stroke();
	  ctx.beginPath();
	  ctx.lineWidth=2;
	  ctx.arc(100, 260, 50, 0, 2 * Math.PI, false); // bottom left
    ctx.stroke();
    ctx.beginPath();
	  ctx.lineWidth=2;
	  ctx.arc(220, 260, 50, 0, 2 * Math.PI, false); // bottom mid
    ctx.stroke();
    ctx.beginPath();
	  ctx.lineWidth=2;
	  ctx.arc(340, 260, 50, 0, 2 * Math.PI, false); // bottom right
    ctx.stroke();
	}

	function actionTopLeft(fillColor) {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
    ctx.arc(100, 120, 50, 0, 2 * Math.PI, false); // top left
	  ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.stroke();
	}

	function actionTopMid(fillColor) {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
	  ctx.arc(220, 120, 50, 0, 2 * Math.PI, false); // top mid
	  ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.stroke();
	}

	function actionTopRight(fillColor) {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
	  ctx.arc(340, 120, 50, 0, 2 * Math.PI, false); // top right
	  ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.stroke();
	}

	function actionBottomLeft(fillColor) {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
	  ctx.arc(100, 260, 50, 0, 2 * Math.PI, false); // bottom left
	  ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.stroke();
	}

	function actionBottomMid(fillColor) {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
	  ctx.arc(220, 260, 50, 0, 2 * Math.PI, false); // bottom mid
	  ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.stroke();
	}

	function actionBottomRight(fillColor) {
	  var c = document.getElementById("myCanvas");
    var ctx = c.getContext("2d");
    ctx.beginPath();
    ctx.lineWidth=2;
	  ctx.arc(340, 260, 50, 0, 2 * Math.PI, false); // bottom right
	  ctx.fillStyle = fillColor;
    ctx.fill();
    ctx.stroke();
	}

  function toggleWinImg() {
    var img = document.getElementById('win');
    img.classList.toggle('hidden')
    img.classList.toggle('visible')
	var winmsg = document.getElementById('wintxt');
	winmsg.classList.toggle('hidden');
	winmsg.classList.toggle('visible');
  }

  function togglePop1() {
    var img = document.getElementById('pop');
    img.src="pop1.gif";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

  function togglePop2() {
    var img = document.getElementById('pop');
    img.src="pop2.gif";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

  function togglePop3() {
    var img = document.getElementById('pop');
    img.src="pop3.gif";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

  function togglePop4() {
    var img = document.getElementById('pop');
    img.src="pop4.gif";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

  function togglePop5() {
    var img = document.getElementById('pop');
    img.src="pop5.gif";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

  function togglePop6() {
    var img = document.getElementById('pop');
    img.src="pop6.gif";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

  function clearImg() {
    var img = document.getElementById('pop');
    img.src="";
    img.classList.toggle('hidden');
    img.classList.toggle('visible')
  }

    // running code
  var topLeft = false;
  var topMid = false;
  var topRight = false;
  var bottomLeft = false;
  var bottomMid = false;
  var bottomRight = false;
  var doBoom = false;

  var pop1 = false;
  var pop2 = false;
  var pop3 = false;
  var pop4 = false;
  var pop5 = false;
  var pop6 = false;

  var win = false;
  var won = false;

	drawBalloonMap();

	//update every 250 milisec (0.25 seconds)
    var update2 = setInterval(function() {
        fetch("balloons_data.json")
            .then(response => response.json())
            .then(data => {

                if (data.top_left_popped == 0) {
                  actionTopLeft("black");
                  topLeft = false;
                } else if (data.top_left_popped == 1) {
                  actionTopLeft("red");
                  if (!topLeft) {
                    pop1 = true;
                  }
                  topLeft = true;
                } else {
                  actionTopLeft("yellow");
                  // INDICATES ERROR
                }

                if (data.top_mid_popped == 0) {
                  actionTopMid("black");
                  topMid = false;
                } else if (data.top_mid_popped == 1) {
                  actionTopMid("red");
                  if (!topMid) {
                    pop2 = true;
                  }
                  topMid = true;
                } else {
                  actionTopMid("yellow");
                  // INDICATES ERROR
                }

                if (data.top_right_popped == 0) {
                  actionTopRight("black");
                  topRight = false;
                } else if (data.top_right_popped == 1) {
                  actionTopRight("red");
                  topRight = true;
                  if (!topRight) {
                    pop3 = true;
                  }
                } else {
                  actionTopRight("yellow");
                  // INDICATES ERROR
                }

                if (data.bottom_left_popped == 0) {
                  actionBottomLeft("black");
                  bottomLeft = false;
                } else if (data.bottom_left_popped == 1) {
                  actionBottomLeft("red");
                  if (!bottomLeft) {
                    pop4 = true;
                  }
                  bottomLeft = true;
                } else {
                  actionBottomLeft("yellow");
                  // INDICATES ERROR
                }

                if (data.bottom_mid_popped == 0) {
                  actionBottomMid("black");
                  bottomMid = false;
                } else if (data.bottom_mid_popped == 1) {
                  actionBottomMid("red");
                  bottomMid = true;
                  if (!bottomMid) {
                    pop5 = true;
                  }
                } else {
                  actionBottomMid("yellow");
                  // INDICATES ERROR
                }

				        if (data.bottom_right_popped == 0) {
                  actionBottomRight("black");
                  bottomRight = false;
                } else if (data.bottom_right_popped == 1) {
                  actionBottomRight("red");
                  if (!bottomRight) {
                    pop6 = true;
                  }
                  bottomRight = true;
                } else {
                  actionBottomRight("yellow");
                  // INDICATES ERROR
                }
                if (topLeft && topMid && topLeft && bottomLeft && bottomMid && bottomRight) {
                  win = true;
                }
                if (pop1) {
                  if (!win) {
                    togglePop1();
                    setTimeout(() => {clearImg();}, 3000);
                    pop1 = false;
                  }
                }
                if (pop2) {
                  if (!win) {
                    togglePop2();
                    setTimeout(() => {clearImg();}, 3000);
                    pop2 = false;
                  }
                }
                if (pop3) {
                  if (!win) {
                    togglePop3();
                    setTimeout(() => {clearImg();}, 3000);
                    pop3 = false;
                  }
                }
                if (pop4) {
                  if (!win) {
                    togglePop4();
                    setTimeout(() => {clearImg();}, 3000);
                    pop4 = false;
                  }
                }
                if (pop5) {
                  if (!win) {
                    togglePop5();
                    setTimeout(() => {clearImg();}, 3000);
                    pop5 = false;
                  }
                }
                if (pop6) {
                  if (!win) {
                    togglePop6();
                    setTimeout(() => {clearImg();}, 3000);
                    pop6 = false;
                  }
                }
               if (win) {
                 if (!won) {
                   toggleWinImg();
                   setTimeout(() => {toggleWinImg();}, 3000);
                 }
                 won = true;
               }
        })
    }, 100);
</script>

  </body>
</html>
